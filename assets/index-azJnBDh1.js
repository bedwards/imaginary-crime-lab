import{r as h,a as F,R as W}from"./react-vendor-nf7bT_Uh.js";import{M as S,S as U,C as P,D as V}from"./icons-Dykj88lH.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const x of c.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&d(x)}).observe(document,{childList:!0,subtree:!0});function u(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(t){if(t.ep)return;t.ep=!0;const c=u(t);fetch(t.href,c)}})();var R={exports:{}},f={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q=h,q=Symbol.for("react.element"),X=Symbol.for("react.fragment"),Y=Object.prototype.hasOwnProperty,K=Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ee={key:!0,ref:!0,__self:!0,__source:!0};function _(m,l,u){var d,t={},c=null,x=null;u!==void 0&&(c=""+u),l.key!==void 0&&(c=""+l.key),l.ref!==void 0&&(x=l.ref);for(d in l)Y.call(l,d)&&!ee.hasOwnProperty(d)&&(t[d]=l[d]);if(m&&m.defaultProps)for(d in l=m.defaultProps,l)t[d]===void 0&&(t[d]=l[d]);return{$$typeof:q,type:m,key:c,ref:x,props:t,_owner:K.current}}f.Fragment=X;f.jsx=_;f.jsxs=_;R.exports=f;var e=R.exports,v={},I=F;v.createRoot=I.createRoot,v.hydrateRoot=I.hydrateRoot;const p="https://crime-lab.brian-mabry-edwards.workers.dev";function se(){const[m,l]=h.useState([]),[u,d]=h.useState([]),[t,c]=h.useState([]),[x,g]=h.useState("evidence"),[D,y]=h.useState(!0),[b,O]=h.useState(null),[N,T]=h.useState([]),[L,w]=h.useState("React (GitHub Pages) â†’ Workers (Edge) â†’ Neon (Postgres) + MongoDB (Live) + Shopify (Commerce)");h.useEffect(()=>{C()},[]);const C=async()=>{try{const[s,o,a,i]=await Promise.all([fetch(`${p}/cases`),fetch(`${p}/evidence`),fetch(`${p}/metrics`),fetch(`${p}/purchased-evidence`)]),r=await s.json(),n=await o.json(),j=await a.json(),J=await i.json();l(r),d(n),O(j),T(J),y(!1)}catch(s){console.error("Failed to load data:",s),y(!1)}},Z=async(s,o)=>{try{const i=await(await fetch(`${p}/detective-comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({evidenceTitle:s,caseTitle:o})})).json();i.comment&&(w(i.comment),setTimeout(()=>{w("React (GitHub Pages) â†’ Workers (Edge) â†’ Neon (Postgres) + MongoDB (Live) + Shopify (Commerce)")},8e3))}catch(a){console.error("Failed to get detective comment:",a)}},k=s=>{var r;if(t.find(n=>n.id===s.id))return;c([...t,s]);const o=(r=s.cases)==null?void 0:r[0],a=m.find(n=>n.id===o),i=(a==null?void 0:a.title)||"the case";Z(s.title,i),fetch(`${p}/activity`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"cart_add",evidence_id:s.id,timestamp:new Date().toISOString()})}).catch(console.error)},A=s=>{c(t.filter(o=>o.id!==s))},M=async()=>{const s={};t.forEach(a=>{var i;(i=a.cases)==null||i.forEach(r=>{s[r]||(s[r]=[]),s[r].push(a.id)})});const o=Object.entries(s).filter(([a,i])=>{const r=m.find(n=>n.id===parseInt(a));return i.length===r.evidence_count}).map(([a])=>parseInt(a));try{const i=await(await fetch(`${p}/checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({evidenceIds:t.map(r=>r.id),caseIds:o})})).json();window.location.href=i.checkoutUrl}catch(a){console.error("Checkout failed:",a),alert("Checkout failed. Please try again.")}},$=t.reduce((s,o)=>s+parseFloat(o.price),0),B=async()=>{if(confirm("This will reset all progress. Are you sure?"))try{await fetch(`${p}/reset-progress`,{method:"POST"}),c([]),await C()}catch(s){console.error("Reset failed:",s)}},z=({item:s})=>{var r;const o=t.find(n=>n.id===s.id),a=N.includes(s.id),i=((r=s.cases)==null?void 0:r.map(n=>m.find(j=>j.id===n)).filter(Boolean))||[];return e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s.description}),i.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"Required for:"}),i.map(n=>e.jsxs("div",{className:"text-xs text-gray-700 flex items-center gap-1",children:[e.jsx("span",{children:n.title}),n.solved_at&&e.jsx(P,{size:12,className:"text-green-600"})]},n.id))]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["$",s.price]}),a?e.jsx("span",{className:"px-4 py-2 bg-green-100 text-green-800 rounded text-sm font-semibold",children:"Purchased"}):o?e.jsx("button",{onClick:()=>A(s.id),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"Remove"}):e.jsx("button",{onClick:()=>k(s),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add to Cart"})]})]})})},G=({caseItem:s})=>{const a=u.filter(r=>{var n;return(n=r.cases)==null?void 0:n.includes(s.id)}).filter(r=>t.find(n=>n.id===r.id)||N.includes(r.id)).length,i=a/s.evidence_count*100;return e.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 ${s.solved_at?"border-2 border-green-500":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:s.case_number}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.title}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.difficulty==="easy"?"bg-green-100 text-green-800":s.difficulty==="hard"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.difficulty.toUpperCase()})})]}),s.solved_at&&e.jsx(P,{size:32,className:"text-green-600"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Evidence Collected"}),e.jsxs("span",{className:"font-semibold",children:[a," / ",s.evidence_count]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${i}%`}})})]}),s.solved_at&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 rounded border border-green-200",children:[e.jsx("div",{className:"text-sm font-bold text-green-900 mb-2",children:"âœ“ CASE SOLVED"}),e.jsx("div",{className:"text-sm text-green-800",children:s.solution})]})]})},H=()=>b?e.jsxs("div",{className:"bg-amber-50 border-2 border-amber-300 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-900 mb-4 flex items-center gap-2",children:[e.jsx(V,{size:20}),"System Internals (Live)"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded p-4",children:[e.jsx("div",{className:"text-xs font-bold text-amber-800 mb-2",children:"POSTGRES (Neon)"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-amber-800",children:"Total Cases:"}),e.jsx("span",{className:"font-bold text-amber-900",children:b.cases.total})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-amber-800",children:"Solved Cases:"}),e.jsx("span",{className:"font-bold text-green-600",children:b.cases.solved})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-amber-800",children:"Total Purchases:"}),e.jsx("span",{className:"font-bold text-amber-900",children:b.purchases})]})]})]}),e.jsxs("div",{className:"bg-white rounded p-4",children:[e.jsx("div",{className:"text-xs font-bold text-amber-800 mb-2",children:"SHOPIFY (Commerce)"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-amber-800",children:"Products Synced:"}),e.jsx("span",{className:"font-bold text-amber-900",children:u.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-amber-800",children:"Cache Strategy:"}),e.jsx("span",{className:"font-mono text-xs text-amber-700",children:"Edge w/ 5min TTL"})]})]})]})]}),e.jsx("button",{onClick:B,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded",children:"Reset Progress"})]}):null;return D?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-cyan-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:"ðŸ”¬"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:"Loading Crime Lab..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-slate-900 via-blue-900 to-cyan-900 text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0dGVybiBpZD0iZ3JpZCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBwYXR0ZXJuVW5pdHM9InVzZXJTcGFjZU9uVXNlIj48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDMpIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=')] opacity-50"}),e.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(S,{size:48,className:"text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Imaginary Crime Lab"}),e.jsx("p",{className:"text-cyan-200",children:"Cases solve themselves when you collect all the evidence"})]})]}),e.jsx("div",{className:"mt-4 text-sm font-mono text-cyan-300 bg-slate-800/50 px-4 py-2 rounded border border-cyan-500/30 transition-all duration-300",children:L})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[e.jsxs("nav",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>g("cases"),className:`w-full text-left px-4 py-3 rounded flex items-center gap-2 ${x==="cases"?"bg-blue-600 text-white":"hover:bg-gray-100"}`,children:[e.jsx(S,{size:20}),"Active Cases"]}),e.jsx("button",{onClick:()=>g("evidence"),className:`w-full text-left px-4 py-3 rounded flex items-center gap-2 ${x==="evidence"?"bg-blue-600 text-white":"hover:bg-gray-100"}`,children:"ðŸ“¦ Evidence Store"}),e.jsx("button",{onClick:()=>g("internals"),className:`w-full text-left px-4 py-3 rounded flex items-center gap-2 ${x==="internals"?"bg-blue-600 text-white":"hover:bg-gray-100"}`,children:"âš™ï¸ System Internals"})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold flex items-center gap-2",children:[e.jsx(U,{size:18}),"Cart"]}),e.jsx("span",{className:"bg-blue-600 text-white px-2 py-1 rounded-full text-xs",children:t.length})]}),t.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:t.map(s=>e.jsx("div",{className:"truncate",children:s.title},s.id))}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[e.jsx("span",{className:"font-bold",children:"Total:"}),e.jsxs("span",{className:"text-lg font-bold text-blue-600",children:["$",$.toFixed(2)]})]}),e.jsx("button",{onClick:M,className:"w-full mt-3 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-semibold",children:"Purchase & Solve Cases"})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No items in cart"})]})]})}),e.jsxs("div",{className:"lg:col-span-3",children:[x==="cases"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Active Cases"}),m.map(s=>e.jsx(G,{caseItem:s},s.id))]}),x==="evidence"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Evidence Store"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.map(s=>e.jsx(z,{item:s},s.id))})]}),x==="internals"&&e.jsx(H,{})]})]})})]})}const E=document.getElementById("loading");E&&E.classList.add("hidden");v.createRoot(document.getElementById("root")).render(e.jsx(W.StrictMode,{children:e.jsx(se,{})}));
//# sourceMappingURL=index-azJnBDh1.js.map
